{"version":3,"sources":["assets\\code\\item.js"],"names":["cc","Class","Component","properties","id","type","spawned","potionPrefab","Prefab","cakePrefab","cakeProb","potoinProb","opened","animateFloating","jumpUp","tween","by","y","easing","jumpDown","sequence","repeatForever","openChest","isPlayer","node","getComponent","AudioSource","play","randNum","Math","floor","random","spawnType","find","sendItemState","x","makeid","text","possible","i","charAt","length","onLoad","name","then","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        id: \"\",\r\n        type: \"\",\r\n        spawned: false,\r\n        potionPrefab: cc.Prefab,\r\n        cakePrefab: cc.Prefab,\r\n        cakeProb: 30,\r\n        potoinProb: 30,\r\n        opened: false,\r\n    },\r\n\r\n    animateFloating() {\r\n        var jumpUp = cc.tween().by(1, { y:  20 }, { easing: 'sineOut' });\r\n        var jumpDown = cc.tween().by(1, { y: -20 }, { easing: 'sineIn' });\r\n        var tween = cc.tween().sequence(jumpUp, jumpDown);\r\n        return cc.tween().repeatForever(tween);\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    openChest(isPlayer) {\r\n        if (!this.opened) {\r\n            this.opened = true;\r\n            if (isPlayer) {\r\n                this.node.getComponent(cc.AudioSource).play(); // play sound\r\n                let randNum = Math.floor(Math.random() * 100);\r\n                let spawnType = \"\";\r\n                if (randNum <= this.cakeProb) {\r\n\r\n                    spawnType = \"cake\";\r\n\r\n                }\r\n                else if (randNum <= (this.cakeProb + this.potoinProb)) {\r\n\r\n                    spawnType = \"potion\";\r\n                }\r\n                else {\r\n                    //console.log(\"spawn bomb\");\r\n                    //spawnType = \"potion\";\r\n                }\r\n                this.spawned = true;\r\n                if (spawnType != \"\")\r\n                    cc.find(\"system\").getComponent(\"client\").sendItemState(this.id, \"spawn\", spawnType, [this.node.x + 50, this.node.y + 50]);\r\n                cc.find(\"system\").getComponent(\"client\").sendItemState(this.id, \"spawn\", \"chest\", [this.node.x, this.node.y]);\r\n                cc.find(\"system\").getComponent(\"client\").sendItemState(this.id, \"used\", \"chest\", null);\r\n            }\r\n        } \r\n    },\r\n    makeid() {\r\n        var text = \"\";\r\n        var possible = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\n\r\n        for(var i = 0; i< 5; i++)\r\n            text += possible.charAt(Math.floor(Math.random() * possible.length));\r\n\r\n        return text;\r\n    },\r\n    onLoad() {\r\n        if (this.id == null)\r\n            this.id = this.makeid();\r\n        this.node.name = this.type + this.id;\r\n        if (this.type != \"chest\") {\r\n            //start floating animation\r\n            cc.tween(this.node).then(this.animateFloating()).start();\r\n        }\r\n        \r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}