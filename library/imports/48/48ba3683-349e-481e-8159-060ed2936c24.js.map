{"version":3,"sources":["assets\\code\\hitChecker.js"],"names":["cc","Class","Component","properties","player","Node","die","getComponent","isPlayer","RigidBody","linearVelocity","Vec2","x","find","spawn","y","growing","sys","platform","WECHAT_GAME","wx","vibrateShort","win","won","active","sendPlayerState","disable","enabled","getChildByName","AudioSource","play","eatCake","cake","ateCake","sendItemState","id","drinkPotion","potion","atePotion","openChest","chest","setCheckPoint","checkpoint","Animation","onCollisionEnter","other","self","node","group","type","onLoad","getParent","update","dt"],"mappings":"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","sourceRoot":"/","sourcesContent":["// Learn cc.Class:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        player: cc.Node,\r\n    },\r\n\r\n    die() {\r\n        if (this.player.getComponent(\"movement\").isPlayer) {\r\n            this.player.getComponent(cc.RigidBody).linearVelocity = cc.Vec2(0, 0);\r\n            this.player.x = cc.find(\"system\").getComponent(\"gameManager\").spawn.x;\r\n            this.player.y = cc.find(\"system\").getComponent(\"gameManager\").spawn.y;\r\n            this.player.getComponent(\"movement\").growing = 1;\r\n            if (cc.sys.platform == cc.sys.WECHAT_GAME)\r\n                wx.vibrateShort(\"medium\");\r\n        }   \r\n    },\r\n\r\n    win() {\r\n       \r\n        if (this.player.getComponent(\"movement\").isPlayer && !cc.find(\"system\").getComponent(\"client\").won) {\r\n            cc.find(\"Canvas/UI/MOBILE\").active = false;\r\n            cc.find(\"system\").getComponent(\"client\").won = true;\r\n            cc.find(\"system\").getComponent(\"client\").sendPlayerState(\"win\");\r\n            this.player.getComponent(\"movement\").disable();\r\n            this.enabled = false;\r\n            cc.find(\"system\").getChildByName(\"AUDIO\").getChildByName(\"WIN\").getComponent(cc.AudioSource).play();\r\n        }    \r\n    },\r\n\r\n    eatCake(cake) {\r\n        if (this.player.getComponent(\"movement\").isPlayer) {\r\n            this.player.getComponent(\"movement\").ateCake = true;\r\n            cc.find(\"system\").getComponent(\"client\").sendItemState(cake.getComponent(\"item\").id, \"used\", \"cake\", null);\r\n            cc.find(\"Canvas/UI/MOBILE/CAKE\").active = true;\r\n\r\n    \r\n        }\r\n        \r\n    },\r\n    \r\n    drinkPotion(potion) {\r\n        if (this.player.getComponent(\"movement\").isPlayer) {\r\n            this.player.getComponent(\"movement\").atePotion = true;\r\n            cc.find(\"system\").getComponent(\"client\").sendItemState(potion.getComponent(\"item\").id, \"used\", \"potion\", null);\r\n            cc.find(\"Canvas/UI/MOBILE/POTION\").active = true;\r\n        }\r\n    },\r\n    openChest(chest) {\r\n        chest.getComponent(\"item\").openChest(this.player.getComponent(\"movement\").isPlayer);\r\n    },\r\n    setCheckPoint(checkpoint) {\r\n        // check if gotten already\r\n        \r\n        if (this.player.getComponent(\"movement\").isPlayer && cc.find(\"system\").getComponent(\"gameManager\").spawn != checkpoint) {\r\n            cc.find(\"system\").getComponent(\"gameManager\").spawn = checkpoint;\r\n            checkpoint.getChildByName(\"body\").getChildByName(\"FACE\").active = false;\r\n            checkpoint.getChildByName(\"body\").getChildByName(\"FACE2\").active = true;\r\n            checkpoint.getComponent(cc.Animation).play(\"textPopup\");\r\n            checkpoint.getComponent(cc.AudioSource).play();\r\n        }\r\n        \r\n    },\r\n    onCollisionEnter: function (other, self) {\r\n\r\n        if (other.node.group == \"dangerous\")\r\n            this.die();\r\n        else if (other.node.group == \"end\") \r\n            this.win();\r\n        else if (other.node.group == \"checkpoint\")\r\n            this.setCheckPoint(other.node);\r\n        else if (other.node.group == \"item\") {\r\n            if (other.node.getComponent(\"item\").type == \"cake\")\r\n                this.eatCake(other.node);\r\n            else if (other.node.getComponent(\"item\").type == \"potion\")\r\n                this.drinkPotion(other.node);\r\n            else if (other.node.getComponent(\"item\").type == \"chest\")\r\n                this.openChest(other.node);\r\n        }\r\n        \r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        if (this.player == null)\r\n            this.player = this.node.getParent();\r\n    },\r\n\r\n    update(dt) {\r\n        //if (!this.player.getComponent(\"movement\").isPlayer)\r\n        //    this.enabled = false; \r\n    },\r\n});\r\n"]}