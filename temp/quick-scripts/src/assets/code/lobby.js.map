{"version":3,"sources":["assets\\code\\lobby.js"],"names":["payLoad","type","data","PlayerData","id","x","posX","posY","name","status","key","PlayerInfo","crowns","wins","loses","cc","Class","Component","properties","ws","playerNameNode","Node","playerName","joining","buttonText","lobbyInfoText","lobbyStatusText","playerId","connected","errorNode","connecting","tutorials","tutorialIndex","tutorialPage","usernameNode","serverIp","haveUserData","showingLeaderboard","leaderboardNode","leaderboardTitle","playerStatPrefab","Prefab","playerRecordPrefab","recordsNode","recordsTitle","signInNode","inputUsernameNode","passwordNode","password","loginErrorNode","showNext","active","giveSignInError","error","getComponent","Label","string","pressSignIn","signInUp","EditBox","theName","thePassword","sent","toUpperCase","length","i","charCodeAt","WebSocket","addEventListener","send","JSON","stringify","myData","parse","find","sys","localStorage","setItem","console","log","close","refreshLeader","joinLobbySuccessfully","platform","WECHAT_GAME","receiveMessage","updateUsers","room","leaveLobby","director","loadScene","updateStatus","showLeaderboard","closeLeaderboard","closeLobby","closeError","joinLobby","wx","connectSocket","url","onOpen","onMessage","onError","onClose","os","closeSocket","num","pressJoin","watch","createWeChatButton","request","success","res","removeAllChildren","response","player","instantiate","parent","getChildByName","xhr","XMLHttpRequest","onreadystatechange","responseText","open","refreshRecords","speed","openTutorial","nextTutorial","goToStory","sysInfo","window","getSystemInfoSync","width","screenWidth","height","screenHeight","getSetting","authSetting","getUserInfo","userInfo","nickName","login","d","appid","secrect","l","code","method","openid","button","createUserInfoButton","text","style","left","top","backgroundColor","color","fontSize","textAlign","lineHeight","onTap","destroy","onLoad","getStorage","fail","setStorage","getItem","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["class payLoad {\r\n    constructor(type, data) {\r\n        this.type = type;\r\n        this.data = data;\r\n    }\r\n};\r\n\r\nclass PlayerData {\r\n    constructor(id, x) {\r\n        this.id = id;\r\n        this.x = x;\r\n        this.status = 0;\r\n        this.key = '';\r\n    }\r\n    posX = 0;\r\n    posY = 0;\r\n    name = null;\r\n};\r\n\r\n\r\nclass PlayerInfo {\r\n    constructor(id, name, crowns, wins, loses) {\r\n        this.id = id;\r\n        this.name = name;\r\n        this.crowns = crowns;\r\n        this.wins = wins;\r\n        this.loses = loses;\r\n    }\r\n};\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        ws: null,\r\n        playerNameNode: cc.Node,\r\n        playerName: null,\r\n        joining: false,\r\n        buttonText: cc.Node,\r\n        lobbyInfoText: cc.Node,\r\n        lobbyStatusText: cc.Node,\r\n        playerId: null,\r\n        connected: false,\r\n        status: \"(waiting for players...)\",\r\n\r\n        errorNode: cc.Node,\r\n        connecting: false,\r\n\r\n        tutorials: [cc.Node],\r\n        tutorialIndex: 0,\r\n        tutorialPage: cc.Node,\r\n\r\n        usernameNode: cc.Node,\r\n        serverIp: \"\",\r\n        haveUserData: false,\r\n\r\n        showingLeaderboard: true,\r\n        leaderboardNode: cc.Node,\r\n        leaderboardTitle: cc.Node,\r\n        playerStatPrefab: cc.Prefab,\r\n\r\n        playerRecordPrefab: cc.Prefab,\r\n        recordsNode: cc.Node,\r\n        recordsTitle: cc.Node,\r\n\r\n\r\n        signInNode: cc.Node,\r\n        inputUsernameNode: cc.Node,\r\n        passwordNode: cc.Node,\r\n        password: null,\r\n        crowns: 0,\r\n        loginErrorNode: cc.Node,\r\n    },\r\n\r\n    showNext() {\r\n        if (this.showingLeaderboard) {\r\n            this.leaderboardNode.active = false;\r\n            this.leaderboardTitle.active = false;\r\n            this.recordsTitle.active = true;\r\n            this.recordsNode.active = true;\r\n            this.showingLeaderboard = false;\r\n\r\n        } else {\r\n\r\n            this.leaderboardNode.active = true;\r\n            this.leaderboardTitle.active = true;\r\n            this.recordsTitle.active = false;\r\n            this.recordsNode.active = false;\r\n            this.showingLeaderboard = true;\r\n        }\r\n    },\r\n    giveSignInError(error) {\r\n        this.loginErrorNode.getComponent(cc.Label).string = error;\r\n    },\r\n    pressSignIn() {\r\n        this.signInUp(this.inputUsernameNode.getComponent(cc.EditBox).string, this.passwordNode.getComponent(cc.EditBox).string)\r\n    },\r\n    signInUp(theName,thePassword) {\r\n        let sent = false;\r\n        this.playerName = theName.toUpperCase();\r\n        this.password = thePassword;\r\n        if (this.playerName.length < 1 || this.password.length < 1) {\r\n            this.giveSignInError(\"username/password too short\");\r\n            return 0;\r\n        }\r\n        for (var i = 0; i < this.playerName.length; i++){\r\n            if (this.playerName[i].charCodeAt() < 'A'.charCodeAt() || this.playerName[i].charCodeAt() > 'Z'.charCodeAt()) {\r\n                this.giveSignInError(\"username has invalid characters\");\r\n                return 0;\r\n            }\r\n        }\r\n        for (var i = 0; i < this.password.length; i++) {\r\n            if (this.password[i].charCodeAt() < '0'.charCodeAt() || this.password[i].charCodeAt() > 'z'.charCodeAt()) {\r\n                this.giveSignInError(\"password has invalid characters\");\r\n                return 0;\r\n            }\r\n        }\r\n\r\n        this.ws = new WebSocket(\"ws://\" + this.serverIp + \":3002\");\r\n\r\n        this.ws.addEventListener(\"open\", () => {\r\n            if (!sent) {\r\n                this.ws.send(JSON.stringify(new payLoad(\"signIn\", [this.playerName, this.password])));        \r\n                sent = true;\r\n            }\r\n                \r\n        });\r\n\r\n        this.ws.addEventListener('message', ({ data }) => {\r\n            let myData = JSON.parse(data);\r\n            if (myData.type == \"failed\") {\r\n                this.giveSignInError(\"couldn't sign in (check info or username is taken)\");\r\n                return 0;\r\n            }\r\n            else if (myData.type == \"success\") {\r\n                this.playerId = myData.data.id;\r\n                this.crowns = myData.data.crowns;\r\n                cc.find(\"Canvas/CROWNS/num\").getComponent(cc.Label).string = myData.data.crowns;\r\n                cc.find(\"Canvas/WINS\").getComponent(cc.Label).string = myData.data.wins + \" wins\";\r\n                cc.find(\"Canvas/LOSES\").getComponent(cc.Label).string = myData.data.loses + \" loses\";\r\n                cc.find(\"Canvas/USERNAME\").getComponent(cc.Label).string = this.playerName;\r\n                cc.sys.localStorage.setItem(\"username\", JSON.stringify(this.playerName));\r\n                cc.sys.localStorage.setItem(\"password\", JSON.stringify(this.password));\r\n                this.signInNode.active = false;\r\n            }\r\n                \r\n            console.log(\"id = \" + this.playerId);\r\n            this.ws.close();\r\n            this.refreshLeader();\r\n        });\r\n        \r\n    },\r\n    joinLobbySuccessfully() {\r\n\r\n        console.log(\"joined lobby\");\r\n        this.connected = true;\r\n        //if (cc.sys.platform != cc.sys.WECHAT_GAME)\r\n        //    this.playerId = this.playerNameNode.getComponent(cc.EditBox).string;\r\n\r\n        this.joining = true;\r\n        this.buttonText.getComponent(cc.Label).string = \"CANCEL\";\r\n        //this.lobbyInfoText.active = true;\r\n        this.lobbyStatusText.active = true;\r\n\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME)\r\n            this.ws.send({ data: JSON.stringify(new payLoad(\"player_name\", [this.playerName, \"wechat\", this.playerId])) })\r\n        else\r\n            this.ws.send(JSON.stringify(new payLoad(\"player_name\", [this.playerName, \"wechat\", this.playerId])));\r\n    },\r\n    receiveMessage(data) {\r\n        let myData = JSON.parse(data);\r\n        switch (myData.type) {\r\n            case \"lobbyInfo\":\r\n                console.log(myData.data);\r\n                this.updateUsers(myData.data);\r\n                break;\r\n            case \"playerInfo\":\r\n                this.playerId = myData.data;\r\n                console.log(this.playerId);\r\n                break;\r\n            case \"status\":\r\n                if (myData.data[0] == \"starting\") {\r\n                    console.log(\"game is starting in \" + myData.data[1]);\r\n                    this.status = \"(starting in \" + myData.data[1] + \")\";\r\n                }\r\n                else if (myData.data[0] == \"start\") {\r\n                    //start game\r\n                    console.log(\"starting game\");\r\n                    //var thePlayerInfo = {\r\n                    //    id: this.playerId,\r\n                    //    port: myData.data[1],f\r\n                    //};\r\n                    //module.exports = thePlayerInfo;\r\n\r\n                    cc.find(\"MANAGER\").getComponent(\"aboutPlayer\").playerId = this.playerId;\r\n                    cc.find(\"MANAGER\").getComponent(\"aboutPlayer\").room = myData.data[1];\r\n                    cc.find(\"MANAGER\").getComponent(\"aboutPlayer\").serverIp = this.serverIp;\r\n                    cc.find(\"MANAGER\").getComponent(\"aboutPlayer\").crowns = this.crowns;\r\n\r\n                    this.leaveLobby();\r\n\r\n                    switch (myData.data[2]) {\r\n                        case 1: cc.director.loadScene(\"map1\");\r\n                            break;\r\n                        case 2: cc.director.loadScene(\"map2\");\r\n                            break;\r\n                        case 3: cc.director.loadScene(\"map3\");\r\n                            break;\r\n                    }\r\n                    \r\n                }\r\n                else if (myData.data[0] == \"stop\") {\r\n                    this.status = \"(waiting for players...)\";\r\n                }\r\n                this.updateStatus();\r\n                break;\r\n        }\r\n    },\r\n    showLeaderboard() {\r\n        this.leaderboardNode.active = true;\r\n    },\r\n    closeLeaderboard() {\r\n        this.leaderboardNode.active = false;\r\n    },\r\n    closeLobby() {\r\n        console.log(\"disconnected\");\r\n        this.connected = false;\r\n        this.connecting = false;\r\n        this.joining = false;\r\n        this.buttonText.getComponent(cc.Label).string = \"PLAY\";\r\n        this.leaveLobby();\r\n        //this.lobbyInfoText.active = false;\r\n        this.lobbyStatusText.active = false;\r\n    },\r\n\r\n    closeError() {\r\n        this.errorNode.active = false;\r\n    },\r\n    joinLobby() {\r\n        this.connecting = true;\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            console.log(\"yes\");\r\n            this.ws = wx.connectSocket({\r\n                url: \"ws://\" + this.serverIp +\":9091\"\r\n            })\r\n\r\n            this.ws.onOpen(() => {\r\n                this.joinLobbySuccessfully();\r\n            });\r\n\r\n            this.ws.onMessage(({ data }) => {\r\n                this.receiveMessage(data);\r\n            });\r\n\r\n            this.ws.onError(() => {\r\n                console.log(\"couldn't connect\");\r\n                this.errorNode.active = true;\r\n                this.connecting = false;\r\n            })\r\n\r\n\r\n            this.ws.onClose(() => {\r\n                this.closeLobby();        \r\n            })\r\n\r\n        } else {\r\n            console.log(\"no\");\r\n            this.ws = new WebSocket(\"ws://\" + this.serverIp + \":9091\");\r\n\r\n            this.ws.addEventListener(\"open\", () => {\r\n                this.joinLobbySuccessfully();\r\n            });\r\n\r\n            this.ws.addEventListener('message', ({ data }) => {\r\n                this.receiveMessage(data);\r\n            });\r\n\r\n            this.ws.addEventListener(\"error\", () => {\r\n                console.log(\"couldn't connect\");\r\n                this.errorNode.active = true;\r\n                this.connecting = false;\r\n            })\r\n\r\n\r\n            this.ws.addEventListener(\"close\", () => {\r\n                this.closeLobby();\r\n            })\r\n        }\r\n        \r\n\r\n    },\r\n\r\n    leaveLobby() {\r\n        if (cc.sys.os == cc.sys.WECHAT_GAME)\r\n            this.ws.closeSocket();\r\n        else\r\n            this.ws.close();\r\n    },\r\n    updateUsers(num) {\r\n        //this.lobbyInfoText.getComponent(cc.Label).string = num + \"/10 players \";\r\n        this.updateStatus();\r\n    },\r\n    updateStatus() {\r\n        this.lobbyStatusText.getComponent(cc.Label).string = this.status;\r\n    },\r\n    pressJoin() {\r\n\r\n        if (this.playerId != null) {\r\n            this.refreshLeader();\r\n            // cannot join multiple times\r\n            if (this.haveUserData || cc.sys.platform != cc.sys.WECHAT_GAME) {\r\n                if (!this.joining && !this.connecting) {\r\n\r\n                    this.joinLobby();\r\n\r\n                } else {\r\n\r\n                    this.joining = false;\r\n                    this.buttonText.getComponent(cc.Label).string = \"PLAY\";\r\n                    this.leaveLobby();\r\n                    this.lobbyInfoText.active = false; this.watch\r\n                    this.lobbyStatusText.active = false;\r\n                }\r\n            } else {\r\n                this.createWeChatButton();\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    refreshLeader() {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            wx.request({\r\n                url: \"http://\" + this.serverIp + \":3000/\",\r\n                success(res) {\r\n                    cc.find(\"Lobby Manager\").getComponent(\"lobby\").leaderboardNode.removeAllChildren();\r\n\r\n                    var response = res.data.data;\r\n\r\n                    // id - name - crowns - wins - loses\r\n                    for (var i = 0; i < response.length; i++) {\r\n                        let player = cc.instantiate(cc.find(\"Lobby Manager\").getComponent(\"lobby\").playerStatPrefab);\r\n                        player.parent = cc.find(\"Lobby Manager\").getComponent(\"lobby\").leaderboardNode;\r\n                        player.getChildByName(\"PLACE\").getComponent(cc.Label).string = i + 1 + \".\";\r\n                        player.getChildByName(\"NAME\").getComponent(cc.Label).string = response[i].name;\r\n                        player.getChildByName(\"CROWNS\").getComponent(cc.Label).string = response[i].crowns;\r\n                }\r\n            }\r\n            });\r\n            console.log(\"refreshing\");\r\n        } else {\r\n            let xhr = new XMLHttpRequest();\r\n\r\n            xhr.onreadystatechange = function () {\r\n                cc.find(\"Lobby Manager\").getComponent(\"lobby\").leaderboardNode.removeAllChildren();\r\n\r\n                var response = JSON.parse(xhr.responseText).data;\r\n                for (var i = 0; i < response.length; i++) {\r\n                    let player = cc.instantiate(cc.find(\"Lobby Manager\").getComponent(\"lobby\").playerStatPrefab);\r\n                    player.parent = cc.find(\"Lobby Manager\").getComponent(\"lobby\").leaderboardNode;\r\n                    player.getChildByName(\"PLACE\").getComponent(cc.Label).string = i + 1 + \".\";\r\n                    player.getChildByName(\"NAME\").getComponent(cc.Label).string = response[i].name;\r\n                    player.getChildByName(\"CROWNS\").getComponent(cc.Label).string = response[i].crowns;\r\n                }\r\n            };\r\n            xhr.open(\"GET\", \"http://\" + this.serverIp + \":3000/\");\r\n            xhr.send();\r\n        }\r\n        this.refreshRecords();\r\n    },\r\n\r\n\r\n    refreshRecords() {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            wx.request({\r\n                url: \"http://\" + this.serverIp + \":3001/\",\r\n                success(res) {\r\n                    cc.find(\"Lobby Manager\").getComponent(\"lobby\").recordsNode.removeAllChildren();\r\n                    var response = res.data.data;\r\n\r\n                    // id - name - crowns - wins - loses\r\n                    for (var i = 0; i < response.length; i++) {\r\n                        let player = cc.instantiate(cc.find(\"Lobby Manager\").getComponent(\"lobby\").playerRecordPrefab);\r\n                        player.parent = cc.find(\"Lobby Manager\").getComponent(\"lobby\").recordsNode;\r\n                        player.getChildByName(\"PLACE\").getComponent(cc.Label).string = i + 1 + \".\";\r\n                        player.getChildByName(\"NAME\").getComponent(cc.Label).string = response[i].name;\r\n                        player.getChildByName(\"SPEED\").getComponent(cc.Label).string = response[i].speed + \" s\";\r\n                    }\r\n                }\r\n            });\r\n            console.log(\"refreshing\");\r\n        } else {\r\n            let xhr = new XMLHttpRequest();\r\n\r\n            xhr.onreadystatechange = function () {\r\n                cc.find(\"Lobby Manager\").getComponent(\"lobby\").recordsNode.removeAllChildren();\r\n\r\n                var response = JSON.parse(xhr.responseText).data;\r\n                for (var i = 0; i < response.length; i++) {\r\n                    let player = cc.instantiate(cc.find(\"Lobby Manager\").getComponent(\"lobby\").playerRecordPrefab);\r\n                    player.parent = cc.find(\"Lobby Manager\").getComponent(\"lobby\").recordsNode;\r\n                    player.getChildByName(\"PLACE\").getComponent(cc.Label).string = i + 1 + \".\";\r\n                    player.getChildByName(\"NAME\").getComponent(cc.Label).string = response[i].name;\r\n                    player.getChildByName(\"SPEED\").getComponent(cc.Label).string = response[i].speed + \" s\" ;\r\n                }\r\n            };\r\n            xhr.open(\"GET\", \"http://\" + this.serverIp + \":3001/\");\r\n            xhr.send();\r\n        }\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n    openTutorial() {\r\n        this.tutorialPage.active = true;\r\n        this.tutorials[0].active = true;\r\n    },\r\n    nextTutorial() {\r\n        this.tutorials[this.tutorialIndex].active = false;\r\n        this.tutorialIndex += 1;    \r\n        if (this.tutorialIndex < this.tutorials.length) {\r\n            this.tutorials[this.tutorialIndex].active = true;\r\n        } else {\r\n            this.tutorialPage.active = false;\r\n            this.tutorialIndex = 0;\r\n        }\r\n    },\r\n\r\n    goToStory() {\r\n        cc.director.loadScene(\"story\");\r\n    },\r\n\r\n    createWeChatButton() {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            this.playerNameNode.active = false;\r\n            this.usernameNode.active = true;\r\n\r\n\r\n            let sysInfo = window.wx.getSystemInfoSync();\r\n\r\n            let width = sysInfo.screenWidth;\r\n            let height = sysInfo.screenHeight;\r\n            wx.getSetting({\r\n                success(res) {\r\n                    console.log(res.authSetting);\r\n                    if (res.authSetting[\"scope.userInfo\"]) {\r\n                        //something\r\n                        cc.find(\"Lobby Manager\").getComponent(\"lobby\").usernameNode.getComponent(cc.Label).string = \"1\";\r\n                        wx.getUserInfo({\r\n                            success(res) {\r\n                                let userInfo = res.userInfo;\r\n                                cc.find(\"Lobby Manager\").getComponent(\"lobby\").usernameNode.getComponent(cc.Label).string = userInfo.nickName;\r\n                                cc.find(\"Lobby Manager\").getComponent(\"lobby\").playerName = userInfo.nickName;\r\n                                cc.find(\"Lobby Manager\").getComponent(\"lobby\").haveUserData = true;\r\n\r\n                                wx.login({\r\n                                    success: function (res) {\r\n                                        console.log(\"successful\");\r\n                                        var d = {};\r\n                                        d.appid = \"wxa6602e501625471f\";\r\n                                        d.secrect = \"a0af4c896f22ce9c00d61a274e2afad1\";\r\n                                        var l = 'https://api.weixin.qq.com/sns/jscode2session?appid=' + d.appid + '&secret=' + d.secrect + '&js_code=' + res.code + '&grant_type=authorization_code';\r\n                                        wx.request({\r\n                                            url: l,\r\n                                            data: {},\r\n                                            method: 'GET',\r\n                                            success: function (res) {\r\n                                                console.log(res.data.openid);\r\n                                                cc.find(\"Lobby Manager\").getComponent(\"lobby\").playerId = res.data.openid;\r\n                                                cc.find(\"Lobby Manager\").getComponent(\"lobby\").refreshLeader();\r\n                                            }\r\n                                        });\r\n                                    }\r\n                                });\r\n                            }\r\n                        });\r\n                    } else {\r\n                        console.log(\"no\");\r\n\r\n                        let button = wx.createUserInfoButton({\r\n                            type: 'text',\r\n                            text: 'allow miniprogram to use info?',\r\n                            style: {\r\n                                left: 200,\r\n                                top: 100,\r\n                                width: 300,\r\n                                height: 200,\r\n                                backgroundColor: '#FAEB3C',\r\n                                color: '#000000',\r\n                                fontSize: 20,\r\n                                textAlign: \"center\",\r\n                                lineHeight: 200,\r\n                            }\r\n                        });\r\n                        button.onTap((res) => {\r\n                            if (res.userInfo) {\r\n                                //something\r\n                                let userInfo = res.userInfo;\r\n                                cc.find(\"Lobby Manager\").getComponent(\"lobby\").usernameNode.getComponent(cc.Label).string = userInfo.nickName;\r\n\r\n                                button.destroy();\r\n                            } else {\r\n                                //something\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            })\r\n\r\n\r\n        }\r\n    },\r\n    onLoad() {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n\r\n            wx.getStorage({\r\n                key: \"played\",\r\n                success(res) {\r\n                    //played before\r\n\r\n                },\r\n                fail() {\r\n                    cc.find(\"Lobby Manager\").getComponent(\"lobby\").openTutorial();\r\n                    wx.setStorage({\r\n                        key: \"played\",\r\n                        data: \"yes\"\r\n                    });\r\n                }\r\n            })\r\n            this.createWeChatButton();\r\n        } else{\r\n            // check if played before\r\n            if (cc.sys.localStorage.getItem(\"username\") != null && cc.sys.localStorage.getItem(\"password\") != null) {\r\n                this.signInUp(JSON.parse(cc.sys.localStorage.getItem(\"username\")), JSON.parse(cc.sys.localStorage.getItem(\"password\")));\r\n            } else {\r\n                this.openTutorial();\r\n                this.signInNode.active = true;\r\n            }\r\n            \r\n        }\r\n        \r\n        this.refreshLeader();   \r\n        \r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}