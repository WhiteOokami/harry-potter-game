{"version":3,"sources":["assets\\code\\lobby.js"],"names":["payLoad","type","data","PlayerData","id","x","posX","posY","name","status","key","PlayerInfo","crowns","wins","loses","houseIndex","cc","Class","Component","properties","ws","playerNameNode","Node","playerName","joining","buttonText","lobbyInfoText","lobbyStatusText","playerId","connected","errorNode","connecting","tutorials","tutorialIndex","tutorialPage","usernameNode","serverIp","haveUserData","showingLeaderboard","leaderboardNode","leaderboardTitle","playerStatPrefab","Prefab","playerRecordPrefab","recordsNode","recordsTitle","signInNode","inputUsernameNode","passwordNode","password","loginErrorNode","showNext","active","giveSignInError","error","getComponent","Label","string","pressSignIn","signInUp","EditBox","theName","thePassword","sent","toUpperCase","length","i","charCodeAt","WebSocket","addEventListener","send","JSON","stringify","myData","parse","find","changeColor","sys","localStorage","setItem","console","log","close","refreshLeader","changeHouse","num","that","joinLobbySuccessfully","platform","WECHAT_GAME","receiveMessage","updateUsers","abp","room","leaveLobby","director","loadScene","updateStatus","showLeaderboard","closeLeaderboard","closeLobby","closeError","joinLobby","wx","connectSocket","url","onOpen","onMessage","onError","onClose","os","closeSocket","pressJoin","watch","createWeChatButton","houses","request","success","res","removeAllChildren","response","player","instantiate","parent","getChildByName","xhr","XMLHttpRequest","onreadystatechange","responseText","open","refreshRecords","speed","openTutorial","nextTutorial","goToStory","sysInfo","window","getSystemInfoSync","width","screenWidth","height","screenHeight","getSetting","authSetting","getUserInfo","userInfo","nickName","login","d","appid","secrect","l","code","method","openid","button","createUserInfoButton","text","style","left","top","backgroundColor","color","fontSize","textAlign","lineHeight","onTap","destroy","onLoad","getStorage","fail","setStorage","getItem","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["class payLoad {\r\n    constructor(type, data) {\r\n        this.type = type;\r\n        this.data = data;\r\n    }\r\n};\r\n\r\nclass PlayerData {\r\n    constructor(id, x) {\r\n        this.id = id;\r\n        this.x = x;\r\n        this.status = 0;\r\n        this.key = '';\r\n    }\r\n    posX = 0;\r\n    posY = 0;\r\n    name = null;\r\n};\r\n\r\n\r\nclass PlayerInfo {\r\n    constructor(id, name, crowns, wins, loses, houseIndex) {\r\n        this.id = id;\r\n        this.name = name;\r\n        this.crowns = crowns;\r\n        this.wins = wins;\r\n        this.loses = loses;\r\n        this.houseIndex = houseIndex;\r\n    }\r\n};\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        ws: null,\r\n        playerNameNode: cc.Node,\r\n        playerName: null,\r\n        joining: false,\r\n        buttonText: cc.Node,\r\n        lobbyInfoText: cc.Node,\r\n        lobbyStatusText: cc.Node,\r\n        playerId: null,\r\n        connected: false,\r\n        status: \"(waiting for players...)\",\r\n\r\n        errorNode: cc.Node,\r\n        connecting: false,\r\n\r\n        tutorials: [cc.Node],\r\n        tutorialIndex: 0,\r\n        tutorialPage: cc.Node,\r\n\r\n        usernameNode: cc.Node,\r\n        serverIp: \"\",\r\n        haveUserData: false,\r\n\r\n        showingLeaderboard: true,\r\n        leaderboardNode: cc.Node,\r\n        leaderboardTitle: cc.Node,\r\n        playerStatPrefab: cc.Prefab,\r\n\r\n        playerRecordPrefab: cc.Prefab,\r\n        recordsNode: cc.Node,\r\n        recordsTitle: cc.Node,\r\n\r\n\r\n        signInNode: cc.Node,\r\n        inputUsernameNode: cc.Node,\r\n        passwordNode: cc.Node,\r\n        password: null,\r\n        crowns: 0,\r\n        houseIndex: 0,\r\n        loginErrorNode: cc.Node,\r\n    },\r\n\r\n    showNext() {\r\n        if (this.showingLeaderboard) {\r\n            this.leaderboardNode.active = false;\r\n            this.leaderboardTitle.active = false;\r\n            this.recordsTitle.active = true;\r\n            this.recordsNode.active = true;\r\n            this.showingLeaderboard = false;\r\n\r\n        } else {\r\n\r\n            this.leaderboardNode.active = true;\r\n            this.leaderboardTitle.active = true;\r\n            this.recordsTitle.active = false;\r\n            this.recordsNode.active = false;\r\n            this.showingLeaderboard = true;\r\n        }\r\n    },\r\n    giveSignInError(error) {\r\n        this.loginErrorNode.getComponent(cc.Label).string = error;\r\n    },\r\n    pressSignIn() {\r\n        this.signInUp(this.inputUsernameNode.getComponent(cc.EditBox).string, this.passwordNode.getComponent(cc.EditBox).string)\r\n    },\r\n    signInUp(theName,thePassword) {\r\n        let sent = false;\r\n        this.playerName = theName.toUpperCase();\r\n        this.password = thePassword;\r\n        if (this.playerName.length < 1 || this.password.length < 1) {\r\n            this.giveSignInError(\"username/password too short\");\r\n            return 0;\r\n        }\r\n        for (var i = 0; i < this.playerName.length; i++){\r\n            if (this.playerName[i].charCodeAt() < 'A'.charCodeAt() || this.playerName[i].charCodeAt() > 'Z'.charCodeAt()) {\r\n                this.giveSignInError(\"username has invalid characters\");\r\n                return 0;\r\n            }\r\n        }\r\n        for (var i = 0; i < this.password.length; i++) {\r\n            if (this.password[i].charCodeAt() < '0'.charCodeAt() || this.password[i].charCodeAt() > 'z'.charCodeAt()) {\r\n                this.giveSignInError(\"password has invalid characters\");\r\n                return 0;\r\n            }\r\n        }\r\n\r\n        this.ws = new WebSocket(\"ws://\" + this.serverIp + \":3002\");\r\n\r\n        this.ws.addEventListener(\"open\", () => {\r\n            if (!sent) {\r\n                this.ws.send(JSON.stringify(new payLoad(\"signIn\", [this.playerName, this.password])));        \r\n                sent = true;\r\n            }\r\n                \r\n        });\r\n\r\n        this.ws.addEventListener('message', ({ data }) => {\r\n            let myData = JSON.parse(data);\r\n            if (myData.type == \"failed\") {\r\n                this.giveSignInError(\"couldn't sign in (check info or username is taken)\");\r\n                return 0;\r\n            }\r\n            else if (myData.type == \"success\") {\r\n                this.playerId = myData.data.id;\r\n                this.crowns = myData.data.crowns;\r\n                this.houseIndex = myData.data.houseIndex;\r\n                cc.find(\"Canvas/CROWNS/num\").getComponent(cc.Label).string = myData.data.crowns;\r\n                cc.find(\"Canvas/WINS\").getComponent(cc.Label).string = myData.data.wins + \" wins\";\r\n                cc.find(\"Canvas/LOSES\").getComponent(cc.Label).string = myData.data.loses + \" losses\";\r\n                cc.find(\"Canvas/USERNAME\").getComponent(cc.Label).string = this.playerName;\r\n                cc.find(\"MANAGER\").getComponent(\"colorTheme\").changeColor(\"hi\",this.houseIndex);\r\n                cc.sys.localStorage.setItem(\"username\", JSON.stringify(this.playerName));\r\n                cc.sys.localStorage.setItem(\"password\", JSON.stringify(this.password));\r\n                this.signInNode.active = false;\r\n            }\r\n                \r\n            console.log(\"id = \" + this.playerId);\r\n            this.ws.close();\r\n            this.refreshLeader();\r\n        });\r\n        \r\n    },\r\n    changeHouse(num){\r\n        this.houseIndex = num;\r\n        this.ws = new WebSocket(\"ws://\" + this.serverIp + \":3002\");\r\n        this.ws.addEventListener(\"open\", () => {\r\n            this.ws.send(JSON.stringify(new payLoad(\"house\", [this.playerId, num])));\r\n        });\r\n        let that = this;\r\n        this.ws.addEventListener('message', ({ data }) => {\r\n            data = JSON.parse(data);\r\n            if (data.type == \"success\")\r\n                that.refreshLeader();\r\n        });\r\n\r\n    },\r\n    joinLobbySuccessfully() {\r\n\r\n        console.log(\"joined lobby\");\r\n        this.connected = true;\r\n        //if (cc.sys.platform != cc.sys.WECHAT_GAME)\r\n        //    this.playerId = this.playerNameNode.getComponent(cc.EditBox).string;\r\n\r\n        this.joining = true;\r\n        this.buttonText.getComponent(cc.Label).string = \"CANCEL\";\r\n        //this.lobbyInfoText.active = true;\r\n        this.lobbyStatusText.active = true;\r\n\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME)\r\n            this.ws.send({ data: JSON.stringify(new payLoad(\"player_name\", [this.playerName, \"wechat\", this.playerId])) })\r\n        else\r\n            this.ws.send(JSON.stringify(new payLoad(\"player_name\", [this.playerName, \"wechat\", this.playerId])));\r\n    },\r\n    receiveMessage(data) {\r\n        let myData = JSON.parse(data);\r\n        switch (myData.type) {\r\n            case \"lobbyInfo\":\r\n                console.log(myData.data);\r\n                this.updateUsers(myData.data);\r\n                break;\r\n            case \"playerInfo\":\r\n                this.playerId = myData.data;\r\n                console.log(this.playerId);\r\n                break;\r\n            case \"status\":\r\n                if (myData.data[0] == \"starting\") {\r\n                    console.log(\"game is starting in \" + myData.data[1]);\r\n                    this.status = \"(starting in \" + myData.data[1] + \")\";\r\n                }\r\n                else if (myData.data[0] == \"start\") {\r\n                    //start game\r\n                    console.log(\"starting game\");\r\n                    //var thePlayerInfo = {\r\n                    //    id: this.playerId,\r\n                    //    port: myData.data[1],f\r\n                    //};\r\n                    //module.exports = thePlayerInfo;\r\n\r\n                    let abp = cc.find(\"MANAGER\").getComponent(\"aboutPlayer\");\r\n                    abp.playerId = this.playerId;\r\n                    abp.room = myData.data[1];\r\n                    abp.serverIp = this.serverIp;\r\n                    abp.crowns = this.crowns;\r\n                    abp.houseIndex = this.houseIndex;\r\n\r\n                    this.leaveLobby();\r\n\r\n                    switch (myData.data[2]) {\r\n                        case 1: cc.director.loadScene(\"map1\");\r\n                            break;\r\n                        case 2: cc.director.loadScene(\"map2\");\r\n                            break;\r\n                        case 3: cc.director.loadScene(\"map3\");\r\n                            break;\r\n                    }\r\n                    \r\n                }\r\n                else if (myData.data[0] == \"stop\") {\r\n                    this.status = \"(waiting for players...)\";\r\n                }\r\n                this.updateStatus();\r\n                break;\r\n        }\r\n    },\r\n    showLeaderboard() {\r\n        this.leaderboardNode.active = true;\r\n    },\r\n    closeLeaderboard() {\r\n        this.leaderboardNode.active = false;\r\n    },\r\n    closeLobby() {\r\n        console.log(\"disconnected\");\r\n        this.connected = false;\r\n        this.connecting = false;\r\n        this.joining = false;\r\n        this.buttonText.getComponent(cc.Label).string = \"PLAY\";\r\n        this.leaveLobby();\r\n        //this.lobbyInfoText.active = false;\r\n        this.lobbyStatusText.active = false;\r\n    },\r\n\r\n    closeError() {\r\n        this.errorNode.active = false;\r\n    },\r\n    joinLobby() {\r\n        this.connecting = true;\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            console.log(\"yes\");\r\n            this.ws = wx.connectSocket({\r\n                url: \"ws://\" + this.serverIp +\":9091\"\r\n            })\r\n\r\n            this.ws.onOpen(() => {\r\n                this.joinLobbySuccessfully();\r\n            });\r\n\r\n            this.ws.onMessage(({ data }) => {\r\n                this.receiveMessage(data);\r\n            });\r\n\r\n            this.ws.onError(() => {\r\n                console.log(\"couldn't connect\");\r\n                this.errorNode.active = true;\r\n                this.connecting = false;\r\n            })\r\n\r\n\r\n            this.ws.onClose(() => {\r\n                this.closeLobby();        \r\n            })\r\n\r\n        } else {\r\n            console.log(\"no\");\r\n            this.ws = new WebSocket(\"ws://\" + this.serverIp + \":9091\");\r\n\r\n            this.ws.addEventListener(\"open\", () => {\r\n                this.joinLobbySuccessfully();\r\n            });\r\n\r\n            this.ws.addEventListener('message', ({ data }) => {\r\n                this.receiveMessage(data);\r\n            });\r\n\r\n            this.ws.addEventListener(\"error\", () => {\r\n                console.log(\"couldn't connect\");\r\n                this.errorNode.active = true;\r\n                this.connecting = false;\r\n            })\r\n\r\n\r\n            this.ws.addEventListener(\"close\", () => {\r\n                this.closeLobby();\r\n            })\r\n        }\r\n        \r\n\r\n    },\r\n\r\n    leaveLobby() {\r\n        if (cc.sys.os == cc.sys.WECHAT_GAME)\r\n            this.ws.closeSocket();\r\n        else\r\n            this.ws.close();\r\n    },\r\n    updateUsers(num) {\r\n        //this.lobbyInfoText.getComponent(cc.Label).string = num + \"/10 players \";\r\n        this.updateStatus();\r\n    },\r\n    updateStatus() {\r\n        this.lobbyStatusText.getComponent(cc.Label).string = this.status;\r\n    },\r\n    pressJoin() {\r\n\r\n        if (this.playerId != null) {\r\n            this.refreshLeader();\r\n            // cannot join multiple times\r\n            if (this.haveUserData || cc.sys.platform != cc.sys.WECHAT_GAME) {\r\n                if (!this.joining && !this.connecting) {\r\n\r\n                    this.joinLobby();\r\n\r\n                } else {\r\n\r\n                    this.joining = false;\r\n                    this.buttonText.getComponent(cc.Label).string = \"PLAY\";\r\n                    this.leaveLobby();\r\n                    this.lobbyInfoText.active = false; this.watch\r\n                    this.lobbyStatusText.active = false;\r\n                }\r\n            } else {\r\n                this.createWeChatButton();\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    refreshLeader() {\r\n        let houses =  [\"Gry\", \"Huf\", \"Rav\", \"Sly\"];\r\n        let that=this;\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            wx.request({\r\n                url: \"http://\" + this.serverIp + \":3000/\",\r\n                success(res) {\r\n                    cc.find(\"Lobby Manager\").getComponent(\"lobby\").leaderboardNode.removeAllChildren();\r\n\r\n                    var response = res.data.data;\r\n\r\n                    // id - name - crowns - wins - loses\r\n                    for (var i = 0; i < response.length; i++) {\r\n                        let player = cc.instantiate(cc.find(\"Lobby Manager\").getComponent(\"lobby\").playerStatPrefab);\r\n                        player.parent = cc.find(\"Lobby Manager\").getComponent(\"lobby\").leaderboardNode;\r\n                        player.getChildByName(\"PLACE\").getComponent(cc.Label).string = i + 1 + \".\";\r\n                        if(response[i].playerId == this.playerId) player.getChildByName(\"NAME\").getComponent(cc.Label).string = `[${houses[this.houseIndex]}] ` + response[i].name;\r\n                        else player.getChildByName(\"NAME\").getComponent(cc.Label).string = `[${houses[response[i].houseIndex]}] ` + response[i].name;\r\n                        player.getChildByName(\"CROWNS\").getComponent(cc.Label).string = response[i].crowns;\r\n                }\r\n            }\r\n            });\r\n            console.log(\"refreshing\");\r\n        } else {\r\n            let xhr = new XMLHttpRequest();\r\n\r\n            xhr.onreadystatechange = function () {\r\n                cc.find(\"Lobby Manager\").getComponent(\"lobby\").leaderboardNode.removeAllChildren();\r\n                var response = JSON.parse(xhr.responseText).data;\r\n                for (var i = 0; i < response.length; i++) {\r\n                    let player = cc.instantiate(cc.find(\"Lobby Manager\").getComponent(\"lobby\").playerStatPrefab);\r\n                    player.parent = cc.find(\"Lobby Manager\").getComponent(\"lobby\").leaderboardNode;\r\n                    player.getChildByName(\"PLACE\").getComponent(cc.Label).string = i + 1 + \".\";\r\n                    if(response[i].playerId == that.playerId) player.getChildByName(\"NAME\").getComponent(cc.Label).string = `[${houses[that.houseIndex]}] ` + response[i].name;\r\n                    else player.getChildByName(\"NAME\").getComponent(cc.Label).string = `[${houses[response[i].houseIndex]}] ` + response[i].name;\r\n                    player.getChildByName(\"CROWNS\").getComponent(cc.Label).string = response[i].crowns;\r\n                }\r\n            };\r\n            xhr.open(\"GET\", \"http://\" + this.serverIp + \":3000/\");\r\n            xhr.send();\r\n        }\r\n        this.refreshRecords();\r\n    },\r\n\r\n\r\n    refreshRecords() {\r\n        let houses = [\"Gry\", \"Huf\", \"Rav\", \"Sly\"];\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            wx.request({\r\n                url: \"http://\" + this.serverIp + \":3001/\",\r\n                success(res) {\r\n                    cc.find(\"Lobby Manager\").getComponent(\"lobby\").recordsNode.removeAllChildren();\r\n                    var response = res.data.data;\r\n\r\n                    // id - name - crowns - wins - loses\r\n                    for (var i = 0; i < response.length; i++) {\r\n                        let player = cc.instantiate(cc.find(\"Lobby Manager\").getComponent(\"lobby\").playerRecordPrefab);\r\n                        player.parent = cc.find(\"Lobby Manager\").getComponent(\"lobby\").recordsNode;\r\n                        player.getChildByName(\"PLACE\").getComponent(cc.Label).string = i + 1 + \".\";\r\n                        player.getChildByName(\"NAME\").getComponent(cc.Label).string = `[${houses[response[i].houseIndex]}] ` + response[i].name;\r\n                        player.getChildByName(\"SPEED\").getComponent(cc.Label).string = response[i].speed + \" s\";\r\n                    }\r\n                }\r\n            });\r\n            console.log(\"refreshing\");\r\n        } else {\r\n            let xhr = new XMLHttpRequest();\r\n\r\n            xhr.onreadystatechange = function () {\r\n                cc.find(\"Lobby Manager\").getComponent(\"lobby\").recordsNode.removeAllChildren();\r\n\r\n                var response = JSON.parse(xhr.responseText).data;\r\n                for (var i = 0; i < response.length; i++) {\r\n                    let player = cc.instantiate(cc.find(\"Lobby Manager\").getComponent(\"lobby\").playerRecordPrefab);\r\n                    player.parent = cc.find(\"Lobby Manager\").getComponent(\"lobby\").recordsNode;\r\n                    player.getChildByName(\"PLACE\").getComponent(cc.Label).string = i + 1 + \".\";\r\n                    player.getChildByName(\"NAME\").getComponent(cc.Label).string = `[${houses[response[i].houseIndex]}] ` + response[i].name;\r\n                    player.getChildByName(\"SPEED\").getComponent(cc.Label).string = response[i].speed + \" s\" ;\r\n                }\r\n            };\r\n            xhr.open(\"GET\", \"http://\" + this.serverIp + \":3001/\");\r\n            xhr.send();\r\n        }\r\n    },\r\n    // LIFE-CYCLE CALLBACKS:\r\n    openTutorial() {\r\n        this.tutorialPage.active = true;\r\n        this.tutorials[0].active = true;\r\n    },\r\n    nextTutorial() {\r\n        this.tutorials[this.tutorialIndex].active = false;\r\n        this.tutorialIndex += 1;    \r\n        if (this.tutorialIndex < this.tutorials.length) {\r\n            this.tutorials[this.tutorialIndex].active = true;\r\n        } else {\r\n            this.tutorialPage.active = false;\r\n            this.tutorialIndex = 0;\r\n        }\r\n    },\r\n\r\n    goToStory() {\r\n        cc.director.loadScene(\"story\");\r\n    },\r\n\r\n    createWeChatButton() {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n            this.playerNameNode.active = false;\r\n            this.usernameNode.active = true;\r\n\r\n\r\n            let sysInfo = window.wx.getSystemInfoSync();\r\n\r\n            let width = sysInfo.screenWidth;\r\n            let height = sysInfo.screenHeight;\r\n            wx.getSetting({\r\n                success(res) {\r\n                    console.log(res.authSetting);\r\n                    if (res.authSetting[\"scope.userInfo\"]) {\r\n                        //something\r\n                        cc.find(\"Lobby Manager\").getComponent(\"lobby\").usernameNode.getComponent(cc.Label).string = \"1\";\r\n                        wx.getUserInfo({\r\n                            success(res) {\r\n                                let userInfo = res.userInfo;\r\n                                cc.find(\"Lobby Manager\").getComponent(\"lobby\").usernameNode.getComponent(cc.Label).string = userInfo.nickName;\r\n                                cc.find(\"Lobby Manager\").getComponent(\"lobby\").playerName = userInfo.nickName;\r\n                                cc.find(\"Lobby Manager\").getComponent(\"lobby\").haveUserData = true;\r\n\r\n                                wx.login({\r\n                                    success: function (res) {\r\n                                        console.log(\"successful\");\r\n                                        var d = {};\r\n                                        d.appid = \"wxa6602e501625471f\";\r\n                                        d.secrect = \"a0af4c896f22ce9c00d61a274e2afad1\";\r\n                                        var l = 'https://api.weixin.qq.com/sns/jscode2session?appid=' + d.appid + '&secret=' + d.secrect + '&js_code=' + res.code + '&grant_type=authorization_code';\r\n                                        wx.request({\r\n                                            url: l,\r\n                                            data: {},\r\n                                            method: 'GET',\r\n                                            success: function (res) {\r\n                                                console.log(res.data.openid);\r\n                                                cc.find(\"Lobby Manager\").getComponent(\"lobby\").playerId = res.data.openid;\r\n                                                cc.find(\"Lobby Manager\").getComponent(\"lobby\").refreshLeader();\r\n                                            }\r\n                                        });\r\n                                    }\r\n                                });\r\n                            }\r\n                        });\r\n                    } else {\r\n                        console.log(\"no\");\r\n\r\n                        let button = wx.createUserInfoButton({\r\n                            type: 'text',\r\n                            text: 'allow miniprogram to use info?',\r\n                            style: {\r\n                                left: 200,\r\n                                top: 100,\r\n                                width: 300,\r\n                                height: 200,\r\n                                backgroundColor: '#FAEB3C',\r\n                                color: '#000000',\r\n                                fontSize: 20,\r\n                                textAlign: \"center\",\r\n                                lineHeight: 200,\r\n                            }\r\n                        });\r\n                        button.onTap((res) => {\r\n                            if (res.userInfo) {\r\n                                //something\r\n                                let userInfo = res.userInfo;\r\n                                cc.find(\"Lobby Manager\").getComponent(\"lobby\").usernameNode.getComponent(cc.Label).string = userInfo.nickName;\r\n\r\n                                button.destroy();\r\n                            } else {\r\n                                //something\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            })\r\n\r\n\r\n        }\r\n    },\r\n    onLoad() {\r\n        if (cc.sys.platform == cc.sys.WECHAT_GAME) {\r\n\r\n            wx.getStorage({\r\n                key: \"played\",\r\n                success(res) {\r\n                    //played before\r\n\r\n                },\r\n                fail() {\r\n                    cc.find(\"Lobby Manager\").getComponent(\"lobby\").openTutorial();\r\n                    wx.setStorage({\r\n                        key: \"played\",\r\n                        data: \"yes\"\r\n                    });\r\n                }\r\n            })\r\n            this.createWeChatButton();\r\n        } else{\r\n            // check if played before\r\n            if (cc.sys.localStorage.getItem(\"username\") != null && cc.sys.localStorage.getItem(\"password\") != null) {\r\n                this.signInUp(JSON.parse(cc.sys.localStorage.getItem(\"username\")), JSON.parse(cc.sys.localStorage.getItem(\"password\")));\r\n            } else {\r\n                this.openTutorial();\r\n                this.signInNode.active = true;\r\n            }\r\n            \r\n        }\r\n        \r\n        this.refreshLeader();\r\n        \r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}